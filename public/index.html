<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sistema de Inventario</title>
    
    <link rel="stylesheet" href="style.css">

</head>
<body>

    <h1>Gestión de Productos</h1>

    <div class="form-container">
        <h3 style="text-align: center; margin-top: 0;">Agregar Nuevo Producto</h3>
        <form id="form-crear">
            <div class="form-group">
                <input type="text" id="nombre" placeholder="Nombre del producto (ej. Teclado)" required>
            </div>
            <div class="form-group">
                <input type="number" id="precio" placeholder="Precio ($)" required>
            </div>
            <div class="form-group">
                <input type="text" id="marca" placeholder="Marca (ej. Logitech)">
            </div>
            <div class="form-group">
                <input type="text" id="categoria" placeholder="Categoría (ej. Periféricos)">
            </div>
            <button type="submit">Guardar Producto</button>
        </form>
    </div>

    <hr style="max-width: 1200px; margin: 30px auto; opacity: 0.3;">

    <div id="lista-productos" class="grid-productos">
        </div>

    <script>
        const API_URL = '/productos'; 

        async function cargarProductos() {
            try {
                const response = await fetch(API_URL);
                const productos = await response.json();
                
                const contenedor = document.getElementById('lista-productos');
                contenedor.innerHTML = ''; 

                productos.forEach(prod => {
                    const tarjeta = document.createElement('div');
                    tarjeta.className = 'card';
                    tarjeta.innerHTML = `
                        <div class="marca">${prod.marca || 'Genérico'}</div>
                        <h3>${prod.nombre}</h3>
                        <div class="detalles">${prod.categoria || 'Varios'} • Stock: ${prod.stock || 0}</div>
                        <div class="precio">$${prod.precio}</div>
                    `;
                    contenedor.appendChild(tarjeta);
                });
            } catch (error) {
                console.error('Error:', error);
                alert('Error al cargar productos');
            }
        }

        document.getElementById('form-crear').addEventListener('submit', async (e) => {
            e.preventDefault(); 

            const nuevoProducto = {
                nombre: document.getElementById('nombre').value,
                precio: document.getElementById('precio').value,
                marca: document.getElementById('marca').value,
                categoria: document.getElementById('categoria').value
            };

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(nuevoProducto)
                });

                if (response.ok) {
                    alert('Producto guardado!');
                    document.getElementById('form-crear').reset(); 
                    cargarProductos(); 
                } else {
                    const errorData = await response.json();
                    alert('Error al guardar: ' + (errorData.error || 'Desconocido'));
                }
            } catch (error) {
                console.error(error);
                alert('Error de conexión');
            }
        });

        cargarProductos();
    </script>
</body>
</html>